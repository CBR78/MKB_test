# Задание 
*	Добавить возможность сохранения нового объекта обеспечения - самолет (таблица AIRPLANE). При внесении изменений следует предусмотреть возможность добавления новых видов объектов обеспечения.
*	Добавить возможность получения информации о сохраненных самолетах (аналогично тому как это реализовано с автомобилями)
*	Добавить возможность добавлять ко всем объектам обеспечения стоимостные оценки. Для одного объекта обеспечения может быть несколько стоимостных оценок. Стоимостная оценка представляет собой некоторую сумму и время когда эта оценка проводилась. Все оценки должны храниться в БД. При передаче в ExternalApproveService должна использоваться последняя по дате стоимостная оценка для объекта.
Сейчас есть некоторая реализация стоимостной оценки для автомобилей: сумма хранится в таблице CAR вместе с остальными данными, а дата берется текущая. Нужно провести рефакторинг и так же вынести оценки для автомобилей в новую таблицу.
# Пояснения
*	Перед сохранением все объекты обеспечения должны быть проверены через ExternalApproveService (как в коде сейчас происходит для автомобилей)

# Отчет о выполнении задания
При ознакомлении с постановкой задачи, формулировка "При внесении изменений следует предусмотреть возможность добавления новых видов объектов обеспечения." вызвала два вопроса:
1. Значит ли это, что приложение следует переработвть на поддержку произвольных типов обеспечения?
2. Зачит ли, что для каждого произвольного типа обеспечения, приложение должно хранить произвольный набор характеристик (мощность автомобиля, метраж квартиры) с произвольными типами данных (текст, дробное или целое число)?

При возникновении вопросов, программист должен не сам придумывать ответы, а уточнять их у заказчика, что я и сделал, отправив письмо-запрос. Пока ответ не пришел, стал решать, что можно сделать без ответа, в рамках проявления навыков разработки.

По второму вопросу (набор характеристик и их типов) красивого решения придумать не смог, некрасивое и трудоемкое реализовывать, на мой взгляд, неправильно, пока не обсудишь варианты с командой разработки и с фронтом. Рационально на фронте и бэке реализовывать архитектурно-совместимые подходы.

В рамках реализации остальных требований:
1. Разработал новые entity и service-классы:
 - CollateralType - Тип объекта обеспечения. Хранит граничные параметры проверки;
 - Collateral - Объект обеспечения. Хранит фактические параметры для проверки (год изготовления);
 - Assess - Оценка остаточной стоимости. Хранит дату и результаты оценки объектов обеспечения и ссылку на Collateral.

2. Создал новые таблицы в базе данных

3. Для service-метода getLastAssess (последняя оценка Collateral), в rerpository-интерфейсе добавил нативный SQL-запрос с вложенным подзапросом и агрегатной функцией.
 
4. Переработал класс ExternalApproveService для использования новых entity-классов. Убрал проверку на null, организовав валидацию специализированными аннотациями и библиотекой.

5. Подключил Swagger для генерации документации по фактически получившейся API и шаблонов JSON-запросов. 
- XML-оригинал спецификации доступен при запуске этого приложения, по ссылке - http://localhost:8080/v2/api-docs
- Визуализация документации по ссылке http://localhost:8080/swagger-ui.html

- Шаблоны JSON-запросов можно быстро копировать в Postman, для ручного тестирования REST-интерфейсов. Получившийся набор ручных тестов экспортировал из Postman и разместил в корне проекта - файл "MKB_new.postman_collection.json".

6. В DTO для Collateral и Assess, средствами spring-boot-starter-validation реализовал проверку на Null, в том числе каскадную.

- Так-же обеспечил проверку, что при создании Collateral используется CollateralType реально хранящийся в DB. Для этого создал кастомную аннотацию IdExistsInDb и ее обработчик.

- Для формирования развернутого ответа, при непрохождении валидации, создал обработчик RestResponseExceptionHandler.

Для CollateralType валидацию реализовывать пока не стал, т.к. она еще может сильно измениться, при решении "вопроса 2" о хранении произвольных атрибутов с произвольными типами.
